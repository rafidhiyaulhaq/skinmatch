<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SkinMatch API Documentation</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
    <nav class="bg-white shadow-lg">
        <div class="max-w-6xl mx-auto px-4 py-3">
            <h1 class="text-2xl font-bold">SkinMatch API Documentation</h1>
        </div>
    </nav>

    <main class="max-w-6xl mx-auto p-4">
        <div class="bg-white shadow rounded-lg p-6 mb-6">
            <h2 class="text-xl font-bold mb-4">Base URL</h2>
            <code class="bg-gray-100 p-2 rounded">https://skinmatch.up.railway.app</code>
        </div>

        <!-- Auth Endpoints -->
        <div class="bg-white shadow rounded-lg p-6 mb-6">
            <h2 class="text-xl font-bold mb-4">Authentication Endpoints</h2>
            
            <!-- Register -->
            <div class="mb-6">
                <h3 class="text-lg font-semibold mb-2">Register</h3>
                <div class="bg-gray-100 p-4 rounded">
                    <p class="mb-2"><span class="font-bold">URL:</span> /api/auth/register</p>
                    <p class="mb-2"><span class="font-bold">Method:</span> POST</p>
                    <div class="mb-2">
                        <span class="font-bold">Request Body:</span>
                        <pre class="bg-gray-200 p-2 rounded mt-1">
{
  "username": "string",
  "email": "string",
  "password": "string"
}</pre>
                    </div>
                    <button onclick="tryEndpoint('register')" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Try it</button>
                </div>
            </div>

            <!-- Login -->
            <div class="mb-6">
                <h3 class="text-lg font-semibold mb-2">Login</h3>
                <div class="bg-gray-100 p-4 rounded">
                    <p class="mb-2"><span class="font-bold">URL:</span> /api/auth/login</p>
                    <p class="mb-2"><span class="font-bold">Method:</span> POST</p>
                    <div class="mb-2">
                        <span class="font-bold">Request Body:</span>
                        <pre class="bg-gray-200 p-2 rounded mt-1">
{
  "email": "string",
  "password": "string"
}</pre>
                    </div>
                    <button onclick="tryEndpoint('login')" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Try it</button>
                </div>
            </div>

            <!-- Profile -->
            <div class="mb-6">
                <h3 class="text-lg font-semibold mb-2">Get Profile</h3>
                <div class="bg-gray-100 p-4 rounded">
                    <p class="mb-2"><span class="font-bold">URL:</span> /api/auth/profile</p>
                    <p class="mb-2"><span class="font-bold">Method:</span> GET</p>
                    <p class="mb-2"><span class="font-bold">Headers:</span> Authorization: Bearer token</p>
                    <button onclick="tryEndpoint('profile')" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Try it</button>
                </div>
            </div>
        </div>

        <!-- Quiz Endpoints -->
        <div class="bg-white shadow rounded-lg p-6 mb-6">
            <h2 class="text-xl font-bold mb-4">Quiz Endpoints</h2>
            
            <!-- Submit Quiz -->
            <div class="mb-6">
                <h3 class="text-lg font-semibold mb-2">Submit Quiz</h3>
                <div class="bg-gray-100 p-4 rounded">
                    <p class="mb-2"><span class="font-bold">URL:</span> /api/quiz/submit</p>
                    <p class="mb-2"><span class="font-bold">Method:</span> POST</p>
                    <p class="mb-2"><span class="font-bold">Headers:</span> Authorization: Bearer token</p>
                    <div class="mb-2">
                        <span class="font-bold">Request Body:</span>
                        <pre class="bg-gray-200 p-2 rounded mt-1">
{
  "answers": {
    "oiliness": "string",
    "dryness": "string",
    "sensitivity": "string",
    "pores": "string",
    "acne": "string"
  }
}</pre>
                    </div>
                    <button onclick="tryEndpoint('submitQuiz')" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Try it</button>
                </div>
            </div>

            <!-- Quiz History -->
            <div class="mb-6">
                <h3 class="text-lg font-semibold mb-2">Get Quiz History</h3>
                <div class="bg-gray-100 p-4 rounded">
                    <p class="mb-2"><span class="font-bold">URL:</span> /api/quiz/history</p>
                    <p class="mb-2"><span class="font-bold">Method:</span> GET</p>
                    <p class="mb-2"><span class="font-bold">Headers:</span> Authorization: Bearer token</p>
                    <button onclick="tryEndpoint('quizHistory')" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Try it</button>
                </div>
            </div>
        </div>

        <!-- Products Endpoints -->
        <div class="bg-white shadow rounded-lg p-6">
            <h2 class="text-xl font-bold mb-4">Products Endpoints</h2>
            
            <!-- Get Recommendations -->
            <div class="mb-6">
                <h3 class="text-lg font-semibold mb-2">Get Recommendations</h3>
                <div class="bg-gray-100 p-4 rounded">
                    <p class="mb-2"><span class="font-bold">URL:</span> /api/products/recommendations</p>
                    <p class="mb-2"><span class="font-bold">Method:</span> GET</p>
                    <p class="mb-2"><span class="font-bold">Headers:</span> Authorization: Bearer token</p>
                    <p class="mb-2"><span class="font-bold">Query:</span> skinType=string</p>
                    <button onclick="tryEndpoint('recommendations')" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Try it</button>
                </div>
            </div>

            <!-- Get All Products -->
            <div class="mb-6">
                <h3 class="text-lg font-semibold mb-2">Get All Products</h3>
                <div class="bg-gray-100 p-4 rounded">
                    <p class="mb-2"><span class="font-bold">URL:</span> /api/products</p>
                    <p class="mb-2"><span class="font-bold">Method:</span> GET</p>
                    <p class="mb-2"><span class="font-bold">Query Parameters:</span></p>
                    <ul class="list-disc ml-6 mb-2">
                        <li>category (optional)</li>
                        <li>brand (optional)</li>
                        <li>minPrice (optional)</li>
                        <li>maxPrice (optional)</li>
                    </ul>
                    <button onclick="tryEndpoint('products')" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Try it</button>
                </div>
            </div>
        </div>
    </main>

    <!-- Modal for trying endpoints -->
    <div id="endpointModal" class="fixed inset-0 bg-black bg-opacity-50 hidden">
        <div class="bg-white rounded-lg max-w-2xl mx-auto mt-20 p-6">
            <h3 class="text-xl font-bold mb-4" id="modalTitle">Try Endpoint</h3>
            <div id="modalContent"></div>
            <div class="mt-4 flex justify-end">
                <button onclick="closeModal()" class="bg-gray-500 text-white px-4 py-2 rounded mr-2">Close</button>
                <button onclick="sendRequest()" class="bg-blue-500 text-white px-4 py-2 rounded">Send Request</button>
            </div>
        </div>
    </div>

    <script>
        const baseUrl = 'https://skinmatch.up.railway.app';
        let currentEndpoint = '';
        let currentToken = '';

        function tryEndpoint(endpoint) {
            currentEndpoint = endpoint;
            const modal = document.getElementById('endpointModal');
            const modalContent = document.getElementById('modalContent');
            const modalTitle = document.getElementById('modalTitle');
            
            modal.classList.remove('hidden');
            
            let content = '';
            switch(endpoint) {
                case 'register':
                    modalTitle.textContent = 'Register New User';
                    content = `
                        <div class="mb-4">
                            <label class="block mb-2">Username:</label>
                            <input type="text" id="username" class="w-full border p-2 rounded">
                        </div>
                        <div class="mb-4">
                            <label class="block mb-2">Email:</label>
                            <input type="email" id="email" class="w-full border p-2 rounded">
                        </div>
                        <div class="mb-4">
                            <label class="block mb-2">Password:</label>
                            <input type="password" id="password" class="w-full border p-2 rounded">
                        </div>
                    `;
                    break;

                case 'login':
                    modalTitle.textContent = 'Login';
                    content = `
                        <div class="mb-4">
                            <label class="block mb-2">Email:</label>
                            <input type="email" id="email" class="w-full border p-2 rounded">
                        </div>
                        <div class="mb-4">
                            <label class="block mb-2">Password:</label>
                            <input type="password" id="password" class="w-full border p-2 rounded">
                        </div>
                    `;
                    break;

                case 'profile':
                    modalTitle.textContent = 'Get Profile';
                    content = `
                        <div class="mb-4">
                            <label class="block mb-2">Bearer Token:</label>
                            <input type="text" id="token" class="w-full border p-2 rounded" value="${currentToken}">
                        </div>
                    `;
                    break;

                case 'submitQuiz':
                    modalTitle.textContent = 'Submit Quiz';
                    content = `
                        <div class="mb-4">
                            <label class="block mb-2">Bearer Token:</label>
                            <input type="text" id="token" class="w-full border p-2 rounded" value="${currentToken}">
                        </div>
                        <div class="mb-4">
                            <label class="block mb-2">Answers:</label>
                            <textarea id="answers" class="w-full border p-2 rounded" rows="6">{
  "answers": {
    "oiliness": "very_oily",
    "dryness": "not_dry",
    "sensitivity": "not_sensitive",
    "pores": "large_visible",
    "acne": "frequent"
  }
}</textarea>
                        </div>
                    `;
                    break;

                case 'quizHistory':
                    modalTitle.textContent = 'Get Quiz History';
                    content = `
                        <div class="mb-4">
                            <label class="block mb-2">Bearer Token:</label>
                            <input type="text" id="token" class="w-full border p-2 rounded" value="${currentToken}">
                        </div>
                    `;
                    break;

                case 'recommendations':
                    modalTitle.textContent = 'Get Recommendations';
                    content = `
                        <div class="mb-4">
                            <label class="block mb-2">Bearer Token:</label>
                            <input type="text" id="token" class="w-full border p-2 rounded" value="${currentToken}">
                        </div>
                        <div class="mb-4">
                            <label class="block mb-2">Skin Type:</label>
                            <select id="skinType" class="w-full border p-2 rounded">
                                <option value="oily">Oily</option>
                                <option value="dry">Dry</option>
                                <option value="combination">Combination</option>
                                <option value="normal">Normal</option>
                                <option value="sensitive">Sensitive</option>
                            </select>
                        </div>
                    `;
                    break;

                case 'products':
                    modalTitle.textContent = 'Get All Products';
                    content = `
                        <div class="mb-4">
                            <label class="block mb-2">Category (optional):</label>
                            <select id="category" class="w-full border p-2 rounded">
                                <option value="">All</option>
                                <option value="cleanser">Cleanser</option>
                                <option value="toner">Toner</option>
                                <option value="moisturizer">Moisturizer</option>
                            </select>
                        </div>
                        <div class="mb-4">
                            <label class="block mb-2">Brand (optional):</label>
                            <input type="text" id="brand" class="w-full border p-2 rounded">
                        </div>
                        <div class="mb-4">
                            <label class="block mb-2">Min Price (optional):</label>
                            <input type="number" id="minPrice" class="w-full border p-2 rounded">
                        </div>
                        <div class="mb-4">
                            <label class="block mb-2">Max Price (optional):</label>
                            <input type="number" id="maxPrice" class="w-full border p-2 rounded">
                        </div>
                    `;
                    break;
            }
            
            modalContent.innerHTML = content + `
                <div id="response" class="mt-4 hidden">
                    <label class="block mb-2 font-bold">Response:</label>
                    <pre class="bg-gray-100 p-4 rounded overflow-auto max-h-60"></pre>
                </div>
            `;
        }

        function closeModal() {
            document.getElementById('endpointModal').classList.add('hidden');
        }

        async function sendRequest() {
            const responseDiv = document.getElementById('response');
            const responsePre = responseDiv.querySelector('pre');
            responseDiv.classList.remove('hidden');

            try {
                let url = `${baseUrl}/api-test`;
                let options = {
                    headers: {
                        'Content-Type': 'application/json'
                    }
                };

                switch(currentEndpoint) {
                    case 'register':
                        url += '/register';
                        options.method = 'POST';
                        options.body = JSON.stringify({
                            username: document.getElementById('username').value,
                            email: document.getElementById('email').value,
                            password: document.getElementById('password').value
                        });
                        break;

                    case 'login':
                        url += '/login';
                        options.method = 'POST';
                        options.body = JSON.stringify({
                            email: document.getElementById('email').value,
                            password: document.getElementById('password').value
                        });
                        break;

                    case 'profile':
                        url += '/profile';
                        options.method = 'GET';
                        options.headers.Authorization = document.getElementById('token').value;
                        break;

                    case 'submitQuiz':
                        url += '/quiz';
                        options.method = 'POST';
                        options.headers.Authorization = document.getElementById('token').value;
                        options.body = document.getElementById('answers').value;
                        break;

                    case 'quizHistory':
                        url += '/quiz/history';
                        options.method = 'GET';
                        options.headers.Authorization = document.getElementById('token').value;
                        break;

                    case 'recommendations':
                        url += '/products/recommendations';
                        options.method = 'GET';
                        options.headers.Authorization = document.getElementById('token').value;
                        const skinType = document.getElementById('skinType').value;
                        url += `?skinType=${skinType}`;
                        break;

                    case 'products':
                        url += '/products';
                        options.method = 'GET';
                        const params = new URLSearchParams();
                        const category = document.getElementById('category').value;
                        const brand = document.getElementById('brand').value;
                        const minPrice = document.getElementById('minPrice').value;
                        const maxPrice = document.getElementById('maxPrice').value;

                        if (category) params.append('category', category);
                        if (brand) params.append('brand', brand);
                        if (minPrice) params.append('minPrice', minPrice);
                        if (maxPrice) params.append('maxPrice', maxPrice);

                        if (params.toString()) {
                            url += '?' + params.toString();
                        }
                        break;
                }

                const response = await fetch(url, options);
                const data = await response.json();
                
                if (data.token) {
                    currentToken = `Bearer ${data.token}`;
                }
                
                responsePre.textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                responsePre.textContent = JSON.stringify({ error: error.message }, null, 2);
            }
        }
    </script>
</body>
</html>